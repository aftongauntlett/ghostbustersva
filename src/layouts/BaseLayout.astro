---
/**
 * Global site layout — wraps every page.
 * Provides <head>, skip-link, Header, Footer.
 */
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import GhostParticles from "../components/GhostParticles";
import { siteConfig } from "../config";
import "../styles/theme.css";

interface Props {
  /** Page <title> — will be appended with site name */
  title?: string;
  /** Optional meta description override */
  description?: string;
}

const { title, description = siteConfig.description } = Astro.props;
const pageTitle = title ? `${title} | ${siteConfig.title}` : siteConfig.title;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{pageTitle}</title>
    <link rel="icon" type="image/png" href="/images/logo.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Orbitron:wght@500;700&family=Share+Tech+Mono&display=swap"
    />
  </head>
  <body>
    <!-- Skip to main content for keyboard / screen-reader users -->
    <a class="skip-link" href="#main-content">Skip to main content</a>

    <Header />

    <!-- Site-wide floating ghost particles (React island — PRD 009) -->
    <GhostParticles client:load />

    <main id="main-content">
      <slot />
    </main>

    <Footer />

    <style is:global>
      /* -------------------------------------------------- */
      /* Reset & base styles                                */
      /* -------------------------------------------------- */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      /* Theme tokens are defined in /src/styles/theme.css */

      html,
      body {
        height: 100%;
      }

      html {
        font-family: var(--font-body);
        background-color: var(--color-bg);
        color: var(--color-text);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: var(--font-heading);
      }

      h1,
      h2 {
        letter-spacing: var(--tracking-wider);
      }

      h3,
      h4,
      h5,
      h6 {
        letter-spacing: var(--tracking-wide);
      }

      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      main {
        flex: 1;
      }

      a {
        color: var(--color-link);
        text-decoration-skip-ink: auto;
      }
      a:hover,
      a:focus-visible {
        color: var(--color-accent-hover);
      }

      img {
        max-width: 100%;
        height: auto;
        display: block;
      }

      /* Skip-link — visible only on focus */
      .skip-link {
        position: absolute;
        left: -9999px;
        top: 0;
        background: var(--color-accent);
        color: #fff;
        padding: 0.5rem 1rem;
        z-index: 1000;
        font-weight: 600;
      }
      .skip-link:focus {
        left: 0;
      }

      /* Utility wrapper */
      .container {
        width: 100%;
        max-width: var(--max-width);
        margin-inline: auto;
        padding-inline: clamp(1rem, 5vw, 3rem);
      }

      /* ── Site-wide ambient bokeh orbs ── */
      .ghost-particles-global {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
        overflow: hidden;
      }

      /* Base particle style (shared) */
      .ghost-particle-global {
        position: absolute;
        border-radius: 50%;
        will-change: transform, opacity;
      }

      /* Hero — large atmospheric blobs */
      .ghost-particle-global.gp-hero {
        background: radial-gradient(
          circle,
          rgba(0, 230, 118, 0.35) 0%,
          rgba(0, 200, 100, 0.12) 40%,
          rgba(0, 230, 118, 0) 70%
        );
      }

      /* Medium — classic bokeh */
      .ghost-particle-global.gp-medium {
        background: radial-gradient(
          circle,
          rgba(0, 230, 118, 0.6) 0%,
          rgba(0, 230, 118, 0.2) 40%,
          rgba(0, 230, 118, 0) 70%
        );
      }

      /* Tiny — bright sparkle dots */
      .ghost-particle-global.gp-tiny {
        background: radial-gradient(
          circle,
          rgba(0, 255, 130, 0.9) 0%,
          rgba(0, 230, 118, 0.4) 50%,
          rgba(0, 230, 118, 0) 100%
        );
      }

      /* ── Corner fog / smoke ── */
      .corner-fog {
        position: fixed;
        bottom: -40px;
        width: 420px;
        height: 260px;
        pointer-events: none;
        opacity: 0.45;
        filter: blur(40px);
        border-radius: 50%;
        background: radial-gradient(
          ellipse at center,
          rgba(0, 230, 118, 0.28) 0%,
          rgba(0, 200, 100, 0.1) 50%,
          transparent 80%
        );
        animation: fog-drift 14s ease-in-out infinite alternate;
      }

      .corner-fog--left {
        left: -100px;
      }

      .corner-fog--right {
        right: -100px;
        animation-delay: -7s;
        animation-direction: alternate-reverse;
      }

      @keyframes fog-drift {
        0% {
          transform: translateY(0) scale(1);
          opacity: 0.35;
        }
        50% {
          transform: translateY(-18px) scale(1.12);
          opacity: 0.5;
        }
        100% {
          transform: translateY(6px) scale(0.95);
          opacity: 0.3;
        }
      }

      /* Ensure page content sits above particles */
      .skip-link,
      header,
      footer {
        position: relative;
        z-index: 1;
      }

      /* main must NOT create a stacking context so that
         position:fixed lightboxes inside pages can layer
         above the sticky header (z-index: 100). */
      main {
        position: relative;
      }

      @media (prefers-reduced-motion: reduce) {
        .ghost-particles-global,
        .corner-fog {
          display: none !important;
        }
      }
    </style>
  </body>
</html>
